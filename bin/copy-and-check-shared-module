#!/bin/bash
set -euo pipefail
source "$(dirname "$0")/.common"

BASEDIR="$(dirname "${BASH_SOURCE[0]}")"
FOLDER_PATH="$BASEDIR/.."
RELATIVE_PATH=$(realpath --relative-to="$(pwd)" "$FOLDER_PATH")

run_command cd "$RELATIVE_PATH" || exit

run_command npm run postinstall "$@"

run_command npx concurrently -n "cms,course-material,main-frontend,example-exercise" -c "green.bold,red.bold,blue.bold,yellow.bold" "npx tsc -p services/cms/ --noEmit" "npx tsc -p services/course-material/ --noEmit" "npx tsc -p services/main-frontend/ --noEmit" "npx tsc -p services/example-exercise/ --noEmit"

echo "finished"
