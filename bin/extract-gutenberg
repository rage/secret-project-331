#!/bin/bash
set -euo pipefail
source "$(dirname "$0")/.common"

BASEDIR="$(dirname "${BASH_SOURCE[0]}")"

CMS_PATH="$BASEDIR/../services/cms/"

RELATIVE_CMS_PATH=$(realpath --relative-to="$(pwd)" "$CMS_PATH")

run_command cd "$RELATIVE_CMS_PATH" || exit
run_command npm run extract-gutenberg-types

run_command cd ../..
if [ -f "./services/course-material/src/types/GutenbergBlockAttributes.guard.ts" ]; then
  run_command rm ./services/course-material/src/types/GutenbergBlockAttributes.guard.ts
fi

npm run generate-guards-gutenberg
