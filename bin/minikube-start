#!/bin/bash

set -euo pipefail
source ~/secret-project-331/bin/.common

COMMAND="minikube"
cores=$(nproc)

if [[ "$OSTYPE" == "cygwin" || "$OSTYPE" == "msys" || "$OSTYPE" == "win32" ]]; then
  echo "🪟  Detected Windows with $cores available cores."
  ARGUMENTS=(start --vm-driver=virtualbox --addons ingress --cpus "$cores" --disk-size 100g "$@")
elif [[ "$OSTYPE" == "darwin"* ]]; then
  echo "🍎 Detected macOS with $cores available cores."
  ARGUMENTS=(start --addons ingress --cpus "$cores" --disk-size 100g "$@")
else
  echo "🐧 Detected Linux with $cores available cores."
  ARGUMENTS=(start --addons ingress --cpus "$cores" --disk-size 100g "$@")
fi

echo "> $COMMAND" "$(printf "%q " "${ARGUMENTS[@]}")"
exec "$COMMAND" "${ARGUMENTS[@]}"
