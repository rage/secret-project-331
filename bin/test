#!/bin/bash
set -euo pipefail

function ensure_program_in_path() {
  PROGRAM="$1"
  if ! command -v "$PROGRAM" &> /dev/null; then
      echo "$PROGRAM is not installed or it is not in your \$PATH. Aborting."
      exit 1
  fi
}

ensure_program_in_path "skaffold"
ensure_program_in_path "kubectl"
ensure_program_in_path "minikube"
ensure_program_in_path "kustomize"

COMMAND="skaffold"
ARGUMENTS=(dev --force --port-forward -p test "$@")

echo "> $COMMAND" "$(printf "%q " "${ARGUMENTS[@]}")"
exec "$COMMAND" "${ARGUMENTS[@]}"
