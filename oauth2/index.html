<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An extensible, strongly-typed implementation of OAuth2 (RFC 6749) including token introspection (RFC 7662) and token revocation (RFC 7009)."><meta name="keywords" content="rust, rustlang, rust-lang, oauth2"><title>oauth2 - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../oauth2/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate oauth2</p><div class="block version"><p>Version 4.0.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all oauth2's items</p></a><div class="block items"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="oauth2" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">oauth2</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/oauth2/lib.rs.html#1-3042" title="goto source code">[src]</a></span></h1><div class="docblock"><p>An extensible, strongly-typed implementation of OAuth2
(<a href="https://tools.ietf.org/html/rfc6749">RFC 6749</a>) including token introspection (<a href="https://tools.ietf.org/html/rfc7662">RFC 7662</a>)
and token revocation (<a href="https://tools.ietf.org/html/rfc7009">RFC 7009</a>).</p>
<h1 id="contents" class="section-header"><a href="#contents">Contents</a></h1>
<ul>
<li><a href="#importing-oauth2-selecting-an-http-client-interface">Importing <code>oauth2</code>: selecting an HTTP client interface</a></li>
<li><a href="#getting-started-authorization-code-grant-w-pkce">Getting started: Authorization Code Grant w/ PKCE</a>
<ul>
<li><a href="#example-synchronous-blocking-api">Example: Synchronous (blocking) API</a></li>
<li><a href="#example-asyncawait-api">Example: Async/Await API</a></li>
</ul>
</li>
<li><a href="#implicit-grant">Implicit Grant</a></li>
<li><a href="#resource-owner-password-credentials-grant">Resource Owner Password Credentials Grant</a></li>
<li><a href="#client-credentials-grant">Client Credentials Grant</a></li>
<li><a href="#device-code-flow">Device Code Flow</a></li>
<li><a href="#other-examples">Other examples</a>
<ul>
<li><a href="#contributed-examples">Contributed Examples</a></li>
</ul>
</li>
</ul>
<h1 id="importing-oauth2-selecting-an-http-client-interface" class="section-header"><a href="#importing-oauth2-selecting-an-http-client-interface">Importing <code>oauth2</code>: selecting an HTTP client interface</a></h1>
<p>This library offers a flexible HTTP client interface with two modes:</p>
<ul>
<li>
<p><strong>Synchronous (blocking)</strong></p>
<p>The synchronous interface is available for any combination of feature flags.</p>
<p>Example import in <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">oauth2 = &quot;3.0&quot;
</code></pre>
</li>
</ul>
<p>For the HTTP client modes described above, the following HTTP client implementations can be
used:</p>
<ul>
<li>
<p><strong><a href="reqwest/index.html" title="reqwest"><code>reqwest</code></a></strong></p>
<p>The <code>reqwest</code> HTTP client supports both modes. By default, <code>reqwest</code> 0.10 is enabled,
which supports the synchronous and asynchronous <code>futures</code> 0.3 APIs.</p>
<p>Synchronous client: <a href="reqwest/fn.http_client.html" title="reqwest::http_client"><code>reqwest::http_client</code></a></p>
<p>Async/await <code>futures</code> 0.3 client: <a href="reqwest/fn.async_http_client.html" title="reqwest::async_http_client"><code>reqwest::async_http_client</code></a></p>
</li>
<li>
<p><strong>[<code>curl</code>]</strong></p>
<p>The <code>curl</code> HTTP client only supports the synchronous HTTP client mode and can be enabled in
<code>Cargo.toml</code> via the <code>curl</code> feature flag.</p>
<p>Synchronous client: [<code>curl::http_client</code>]</p>
</li>
<li>
<p><strong>[<code>ureq</code>]</strong></p>
<p>The <code>ureq</code> HTTP client is a simple HTTP client with minimal dependencies. It only supports
the synchronous HTTP client mode and can be enabled in <code>Cargo.toml</code> via the <code>ureq</code> feature flag.</p>
</li>
<li>
<p><strong>Custom</strong></p>
<p>In addition to the clients above, users may define their own HTTP clients, which must accept
an <a href="struct.HttpRequest.html" title="HttpRequest"><code>HttpRequest</code></a> and return an <a href="struct.HttpResponse.html" title="HttpResponse"><code>HttpResponse</code></a> or error. Users writing their own clients
may wish to disable the default <code>reqwest</code> 0.10 dependency by specifying
<code>default-features = false</code> in <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">oauth2 = { version = &quot;3.0&quot;, default-features = false }
</code></pre>
<p>Synchronous HTTP clients should implement the following trait:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore">
<span class="ident">FnOnce</span>(<span class="ident">HttpRequest</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">HttpResponse</span>, <span class="ident">RE</span><span class="op">&gt;</span>
<span class="kw">where</span> <span class="ident">RE</span>: <span class="ident">std::error::Error</span> <span class="op">+</span> <span class="lifetime">&#39;static</span></pre></div>
<p>Async/await HTTP clients should implement the following trait:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore">
<span class="ident">FnOnce</span>(<span class="ident">HttpRequest</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">F</span>
<span class="kw">where</span>
  <span class="ident">F</span>: <span class="ident">Future</span><span class="op">&lt;</span><span class="ident">Output</span> <span class="op">=</span> <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">HttpResponse</span>, <span class="ident">RE</span><span class="op">&gt;</span><span class="op">&gt;</span>,
  <span class="ident">RE</span>: <span class="ident">std::error::Error</span> <span class="op">+</span> <span class="lifetime">&#39;static</span></pre></div>
</li>
</ul>
<h1 id="getting-started-authorization-code-grant-w-pkce" class="section-header"><a href="#getting-started-authorization-code-grant-w-pkce">Getting started: Authorization Code Grant w/ PKCE</a></h1>
<p>This is the most common OAuth2 flow. PKCE is recommended whenever the OAuth2 client has no
client secret or has a client secret that cannot remain confidential (e.g., native, mobile, or
client-side web applications).</p>
<h2 id="example-synchronous-blocking-api" class="section-header"><a href="#example-synchronous-blocking-api">Example: Synchronous (blocking) API</a></h2>
<p>This example works with <code>oauth2</code>’s default feature flags, which include <code>reqwest</code> 0.10.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthorizationCode</span>,
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">CsrfToken</span>,
    <span class="ident">PkceCodeChallenge</span>,
    <span class="ident">RedirectUrl</span>,
    <span class="ident">Scope</span>,
    <span class="ident">TokenResponse</span>,
    <span class="ident">TokenUrl</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">oauth2::reqwest::http_client</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="comment">// Create an OAuth2 client by specifying the client ID, client secret, authorization URL and</span>
<span class="comment">// token URL.</span>
<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">Some</span>(<span class="ident">TokenUrl::new</span>(<span class="string">&quot;http://token&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>)
    )
    <span class="comment">// Set the URL the user will be redirected to after the authorization process.</span>
    .<span class="ident">set_redirect_uri</span>(<span class="ident">RedirectUrl::new</span>(<span class="string">&quot;http://redirect&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>);

<span class="comment">// Generate a PKCE challenge.</span>
<span class="kw">let</span> (<span class="ident">pkce_challenge</span>, <span class="ident">pkce_verifier</span>) <span class="op">=</span> <span class="ident">PkceCodeChallenge::new_random_sha256</span>();

<span class="comment">// Generate the full authorization URL.</span>
<span class="kw">let</span> (<span class="ident">auth_url</span>, <span class="ident">csrf_token</span>) <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">authorize_url</span>(<span class="ident">CsrfToken::new_random</span>)
    <span class="comment">// Set the desired scopes.</span>
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;read&quot;</span>.<span class="ident">to_string</span>()))
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;write&quot;</span>.<span class="ident">to_string</span>()))
    <span class="comment">// Set the PKCE code challenge.</span>
    .<span class="ident">set_pkce_challenge</span>(<span class="ident">pkce_challenge</span>)
    .<span class="ident">url</span>();

<span class="comment">// This is the URL you should redirect the user to, in order to trigger the authorization</span>
<span class="comment">// process.</span>
<span class="macro">println!</span>(<span class="string">&quot;Browse to: {}&quot;</span>, <span class="ident">auth_url</span>);

<span class="comment">// Once the user has been redirected to the redirect URL, you&#39;ll have access to the</span>
<span class="comment">// authorization code. For security reasons, your code should verify that the `state`</span>
<span class="comment">// parameter returned by the server matches `csrf_state`.</span>

<span class="comment">// Now you can trade it for an access token.</span>
<span class="kw">let</span> <span class="ident">token_result</span> <span class="op">=</span>
    <span class="ident">client</span>
        .<span class="ident">exchange_code</span>(<span class="ident">AuthorizationCode::new</span>(<span class="string">&quot;some authorization code&quot;</span>.<span class="ident">to_string</span>()))
        <span class="comment">// Set the PKCE code verifier.</span>
        .<span class="ident">set_pkce_verifier</span>(<span class="ident">pkce_verifier</span>)
        .<span class="ident">request</span>(<span class="ident">http_client</span>)<span class="question-mark">?</span>;

<span class="comment">// Unwrapping token_result will either produce a Token or a RequestTokenError.</span></pre></div>
<h2 id="example-asyncawait-api" class="section-header"><a href="#example-asyncawait-api">Example: Async/Await API</a></h2>
<p>One can use async/await as follows:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthorizationCode</span>,
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">CsrfToken</span>,
    <span class="ident">PkceCodeChallenge</span>,
    <span class="ident">RedirectUrl</span>,
    <span class="ident">Scope</span>,
    <span class="ident">TokenResponse</span>,
    <span class="ident">TokenUrl</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">oauth2::reqwest::async_http_client</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="comment">// Create an OAuth2 client by specifying the client ID, client secret, authorization URL and</span>
<span class="comment">// token URL.</span>
<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">Some</span>(<span class="ident">TokenUrl::new</span>(<span class="string">&quot;http://token&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>)
    )
    <span class="comment">// Set the URL the user will be redirected to after the authorization process.</span>
    .<span class="ident">set_redirect_uri</span>(<span class="ident">RedirectUrl::new</span>(<span class="string">&quot;http://redirect&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>);

<span class="comment">// Generate a PKCE challenge.</span>
<span class="kw">let</span> (<span class="ident">pkce_challenge</span>, <span class="ident">pkce_verifier</span>) <span class="op">=</span> <span class="ident">PkceCodeChallenge::new_random_sha256</span>();

<span class="comment">// Generate the full authorization URL.</span>
<span class="kw">let</span> (<span class="ident">auth_url</span>, <span class="ident">csrf_token</span>) <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">authorize_url</span>(<span class="ident">CsrfToken::new_random</span>)
    <span class="comment">// Set the desired scopes.</span>
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;read&quot;</span>.<span class="ident">to_string</span>()))
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;write&quot;</span>.<span class="ident">to_string</span>()))
    <span class="comment">// Set the PKCE code challenge.</span>
    .<span class="ident">set_pkce_challenge</span>(<span class="ident">pkce_challenge</span>)
    .<span class="ident">url</span>();

<span class="comment">// This is the URL you should redirect the user to, in order to trigger the authorization</span>
<span class="comment">// process.</span>
<span class="macro">println!</span>(<span class="string">&quot;Browse to: {}&quot;</span>, <span class="ident">auth_url</span>);

<span class="comment">// Once the user has been redirected to the redirect URL, you&#39;ll have access to the</span>
<span class="comment">// authorization code. For security reasons, your code should verify that the `state`</span>
<span class="comment">// parameter returned by the server matches `csrf_state`.</span>

<span class="comment">// Now you can trade it for an access token.</span>
<span class="kw">let</span> <span class="ident">token_result</span> <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">exchange_code</span>(<span class="ident">AuthorizationCode::new</span>(<span class="string">&quot;some authorization code&quot;</span>.<span class="ident">to_string</span>()))
    <span class="comment">// Set the PKCE code verifier.</span>
    .<span class="ident">set_pkce_verifier</span>(<span class="ident">pkce_verifier</span>)
    .<span class="ident">request_async</span>(<span class="ident">async_http_client</span>)
    .<span class="kw">await</span><span class="question-mark">?</span>;

<span class="comment">// Unwrapping token_result will either produce a Token or a RequestTokenError.</span></pre></div>
<h1 id="implicit-grant" class="section-header"><a href="#implicit-grant">Implicit Grant</a></h1>
<p>This flow fetches an access token directly from the authorization endpoint. Be sure to
understand the security implications of this flow before using it. In most cases, the
Authorization Code Grant flow is preferable to the Implicit Grant flow.</p>
<h2 id="example" class="section-header"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">CsrfToken</span>,
    <span class="ident">RedirectUrl</span>,
    <span class="ident">Scope</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">None</span>
    );

<span class="comment">// Generate the full authorization URL.</span>
<span class="kw">let</span> (<span class="ident">auth_url</span>, <span class="ident">csrf_token</span>) <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">authorize_url</span>(<span class="ident">CsrfToken::new_random</span>)
    .<span class="ident">use_implicit_flow</span>()
    .<span class="ident">url</span>();

<span class="comment">// This is the URL you should redirect the user to, in order to trigger the authorization</span>
<span class="comment">// process.</span>
<span class="macro">println!</span>(<span class="string">&quot;Browse to: {}&quot;</span>, <span class="ident">auth_url</span>);

<span class="comment">// Once the user has been redirected to the redirect URL, you&#39;ll have the access code.</span>
<span class="comment">// For security reasons, your code should verify that the `state` parameter returned by the</span>
<span class="comment">// server matches `csrf_state`.</span>
</pre></div>
<h1 id="resource-owner-password-credentials-grant" class="section-header"><a href="#resource-owner-password-credentials-grant">Resource Owner Password Credentials Grant</a></h1>
<p>You can ask for a <em>password</em> access token by calling the <code>Client::exchange_password</code> method,
while including the username and password.</p>
<h2 id="example-1" class="section-header"><a href="#example-1">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">ResourceOwnerPassword</span>,
    <span class="ident">ResourceOwnerUsername</span>,
    <span class="ident">Scope</span>,
    <span class="ident">TokenResponse</span>,
    <span class="ident">TokenUrl</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">oauth2::reqwest::http_client</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">Some</span>(<span class="ident">TokenUrl::new</span>(<span class="string">&quot;http://token&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>)
    );

<span class="kw">let</span> <span class="ident">token_result</span> <span class="op">=</span>
    <span class="ident">client</span>
        .<span class="ident">exchange_password</span>(
            <span class="kw-2">&amp;</span><span class="ident">ResourceOwnerUsername::new</span>(<span class="string">&quot;user&quot;</span>.<span class="ident">to_string</span>()),
            <span class="kw-2">&amp;</span><span class="ident">ResourceOwnerPassword::new</span>(<span class="string">&quot;pass&quot;</span>.<span class="ident">to_string</span>())
        )
        .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;read&quot;</span>.<span class="ident">to_string</span>()))
        .<span class="ident">request</span>(<span class="ident">http_client</span>)<span class="question-mark">?</span>;</pre></div>
<h1 id="client-credentials-grant" class="section-header"><a href="#client-credentials-grant">Client Credentials Grant</a></h1>
<p>You can ask for a <em>client credentials</em> access token by calling the
<code>Client::exchange_client_credentials</code> method.</p>
<h2 id="example-2" class="section-header"><a href="#example-2">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">Scope</span>,
    <span class="ident">TokenResponse</span>,
    <span class="ident">TokenUrl</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">oauth2::reqwest::http_client</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">Some</span>(<span class="ident">TokenUrl::new</span>(<span class="string">&quot;http://token&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>),
    );

<span class="kw">let</span> <span class="ident">token_result</span> <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">exchange_client_credentials</span>()
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;read&quot;</span>.<span class="ident">to_string</span>()))
    .<span class="ident">request</span>(<span class="ident">http_client</span>)<span class="question-mark">?</span>;</pre></div>
<h1 id="device-code-flow" class="section-header"><a href="#device-code-flow">Device Code Flow</a></h1>
<p>Device Code Flow allows users to sign in on browserless or input-constrained
devices.  This is a two-stage process; first a user-code and verification
URL are obtained by using the <code>Client::exchange_client_credentials</code>
method. Those are displayed to the user, then are used in a second client
to poll the token endpoint for a token.</p>
<h2 id="example-3" class="section-header"><a href="#example-3">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">anyhow</span>;
<span class="kw">use</span> <span class="ident">oauth2</span>::{
    <span class="ident">AuthUrl</span>,
    <span class="ident">ClientId</span>,
    <span class="ident">ClientSecret</span>,
    <span class="ident">DeviceAuthorizationUrl</span>,
    <span class="ident">Scope</span>,
    <span class="ident">TokenResponse</span>,
    <span class="ident">TokenUrl</span>
};
<span class="kw">use</span> <span class="ident">oauth2::basic::BasicClient</span>;
<span class="kw">use</span> <span class="ident">oauth2::devicecode::StandardDeviceAuthorizationResponse</span>;
<span class="kw">use</span> <span class="ident">oauth2::reqwest::http_client</span>;
<span class="kw">use</span> <span class="ident">url::Url</span>;

<span class="kw">let</span> <span class="ident">device_auth_url</span> <span class="op">=</span> <span class="ident">DeviceAuthorizationUrl::new</span>(<span class="string">&quot;http://deviceauth&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>;
<span class="kw">let</span> <span class="ident">client</span> <span class="op">=</span>
    <span class="ident">BasicClient::new</span>(
        <span class="ident">ClientId::new</span>(<span class="string">&quot;client_id&quot;</span>.<span class="ident">to_string</span>()),
        <span class="prelude-val">Some</span>(<span class="ident">ClientSecret::new</span>(<span class="string">&quot;client_secret&quot;</span>.<span class="ident">to_string</span>())),
        <span class="ident">AuthUrl::new</span>(<span class="string">&quot;http://authorize&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>,
        <span class="prelude-val">Some</span>(<span class="ident">TokenUrl::new</span>(<span class="string">&quot;http://token&quot;</span>.<span class="ident">to_string</span>())<span class="question-mark">?</span>),
    )
    .<span class="ident">set_device_authorization_url</span>(<span class="ident">device_auth_url</span>);

<span class="kw">let</span> <span class="ident">details</span>: <span class="ident">StandardDeviceAuthorizationResponse</span> <span class="op">=</span> <span class="ident">client</span>
    .<span class="ident">exchange_device_code</span>()<span class="question-mark">?</span>
    .<span class="ident">add_scope</span>(<span class="ident">Scope::new</span>(<span class="string">&quot;read&quot;</span>.<span class="ident">to_string</span>()))
    .<span class="ident">request</span>(<span class="ident">http_client</span>)<span class="question-mark">?</span>;

<span class="macro">println!</span>(
    <span class="string">&quot;Open this URL in your browser:\n{}\nand enter the code: {}&quot;</span>,
    <span class="ident">details</span>.<span class="ident">verification_uri</span>().<span class="ident">to_string</span>(),
    <span class="ident">details</span>.<span class="ident">user_code</span>().<span class="ident">secret</span>().<span class="ident">to_string</span>()
);

<span class="kw">let</span> <span class="ident">token_result</span> <span class="op">=</span>
    <span class="ident">client</span>
    .<span class="ident">exchange_device_access_token</span>(<span class="kw-2">&amp;</span><span class="ident">details</span>)
    .<span class="ident">request</span>(<span class="ident">http_client</span>, <span class="ident">std::thread::sleep</span>, <span class="prelude-val">None</span>)<span class="question-mark">?</span>;
</pre></div>
<h1 id="other-examples" class="section-header"><a href="#other-examples">Other examples</a></h1>
<p>More specific implementations are available as part of the examples:</p>
<ul>
<li><a href="https://github.com/ramosbugs/oauth2-rs/blob/main/examples/google.rs">Google</a> (includes token revocation)</li>
<li><a href="https://github.com/ramosbugs/oauth2-rs/blob/main/examples/github.rs">Github</a></li>
<li><a href="https://github.com/ramosbugs/oauth2-rs/blob/main/examples/msgraph.rs">Microsoft Graph</a></li>
<li><a href="https://github.com/ramosbugs/oauth2-rs/blob/main/examples/wunderlist.rs">Wunderlist</a></li>
</ul>
<h2 id="contributed-examples" class="section-header"><a href="#contributed-examples">Contributed Examples</a></h2>
<ul>
<li><a href="https://github.com/pka/actix-web-oauth2"><code>actix-web-oauth2</code></a> (version 2.x of this crate)</li>
</ul>
</div><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<table><tr class="import-item"><td><code>pub use <a class="mod" href="../http/index.html" title="mod http">http</a>;</code></td><td class="docblock-short"></td></tr><tr class="import-item"><td><code>pub use <a class="mod" href="../url/index.html" title="mod url">url</a>;</code></td><td class="docblock-short"></td></tr><tr class="import-item"><td><code>pub use revocation::<a class="trait" href="revocation/trait.RevocableToken.html" title="trait oauth2::revocation::RevocableToken">RevocableToken</a>;</code></td><td class="docblock-short"></td></tr><tr class="import-item"><td><code>pub use revocation::<a class="enum" href="revocation/enum.RevocationErrorResponseType.html" title="enum oauth2::revocation::RevocationErrorResponseType">RevocationErrorResponseType</a>;</code></td><td class="docblock-short"></td></tr><tr class="import-item"><td><code>pub use revocation::<a class="enum" href="revocation/enum.StandardRevocableToken.html" title="enum oauth2::revocation::StandardRevocableToken">StandardRevocableToken</a>;</code></td><td class="docblock-short"></td></tr></table><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="basic/index.html" title="oauth2::basic mod">basic</a></td><td class="docblock-short"><p>Basic OAuth2 implementation with no extensions
(<a href="https://tools.ietf.org/html/rfc6749">RFC 6749</a>).</p>
</td></tr><tr class="module-item"><td><a class="mod" href="devicecode/index.html" title="oauth2::devicecode mod">devicecode</a></td><td class="docblock-short"><p>Device Code Flow OAuth2 implementation
(<a href="https://tools.ietf.org/html/rfc8628">RFC 8628</a>).</p>
</td></tr><tr class="module-item"><td><a class="mod" href="helpers/index.html" title="oauth2::helpers mod">helpers</a></td><td class="docblock-short"><p>Helper methods used by OAuth2 implementations/extensions.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="reqwest/index.html" title="oauth2::reqwest mod">reqwest</a></td><td class="docblock-short"><p>HTTP client backed by the <a href="https://crates.io/crates/reqwest">reqwest</a> crate.
Requires “reqwest” feature.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="revocation/index.html" title="oauth2::revocation mod">revocation</a></td><td class="docblock-short"><p>OAuth 2.0 Token Revocation implementation
(<a href="https://tools.ietf.org/html/rfc7009">RFC 7009</a>).</p>
</td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.AccessToken.html" title="oauth2::AccessToken struct">AccessToken</a></td><td class="docblock-short"><p>Access token returned by the token endpoint and used to access protected resources.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.AuthUrl.html" title="oauth2::AuthUrl struct">AuthUrl</a></td><td class="docblock-short"><p>URL of the authorization server’s authorization endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.AuthorizationCode.html" title="oauth2::AuthorizationCode struct">AuthorizationCode</a></td><td class="docblock-short"><p>Authorization code returned from the authorization endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.AuthorizationRequest.html" title="oauth2::AuthorizationRequest struct">AuthorizationRequest</a></td><td class="docblock-short"><p>A request to the authorization endpoint</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Client.html" title="oauth2::Client struct">Client</a></td><td class="docblock-short"><p>Stores the configuration for an OAuth2 client.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ClientCredentialsTokenRequest.html" title="oauth2::ClientCredentialsTokenRequest struct">ClientCredentialsTokenRequest</a></td><td class="docblock-short"><p>A request to exchange client credentials for an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ClientId.html" title="oauth2::ClientId struct">ClientId</a></td><td class="docblock-short"><p>Client identifier issued to the client during the registration process described by
<a href="https://tools.ietf.org/html/rfc6749#section-2.2">Section 2.2</a>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ClientSecret.html" title="oauth2::ClientSecret struct">ClientSecret</a></td><td class="docblock-short"><p>Client password issued to the client during the registration process described by
<a href="https://tools.ietf.org/html/rfc6749#section-2.2">Section 2.2</a>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.CodeTokenRequest.html" title="oauth2::CodeTokenRequest struct">CodeTokenRequest</a></td><td class="docblock-short"><p>A request to exchange an authorization code for an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.CsrfToken.html" title="oauth2::CsrfToken struct">CsrfToken</a></td><td class="docblock-short"><p>Value used for <a href="https://tools.ietf.org/html/rfc6749#section-10.12">CSRF</a> protection
via the <code>state</code> parameter.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.DeviceAccessTokenRequest.html" title="oauth2::DeviceAccessTokenRequest struct">DeviceAccessTokenRequest</a></td><td class="docblock-short"><p>The request for an device access token from the authorization server.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.DeviceAuthorizationRequest.html" title="oauth2::DeviceAuthorizationRequest struct">DeviceAuthorizationRequest</a></td><td class="docblock-short"><p>The request for a set of verification codes from the authorization server.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.DeviceAuthorizationUrl.html" title="oauth2::DeviceAuthorizationUrl struct">DeviceAuthorizationUrl</a></td><td class="docblock-short"><p>URL of the client’s device authorization endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.DeviceCode.html" title="oauth2::DeviceCode struct">DeviceCode</a></td><td class="docblock-short"><p>Device code returned by the device authorization endpoint and used to query the token endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.EmptyExtraTokenFields.html" title="oauth2::EmptyExtraTokenFields struct">EmptyExtraTokenFields</a></td><td class="docblock-short"><p>Empty (default) extra token fields.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.EndUserVerificationUrl.html" title="oauth2::EndUserVerificationUrl struct">EndUserVerificationUrl</a></td><td class="docblock-short"><p>URL of the end-user verification URI on the authorization server.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.HttpRequest.html" title="oauth2::HttpRequest struct">HttpRequest</a></td><td class="docblock-short"><p>An HTTP request.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.HttpResponse.html" title="oauth2::HttpResponse struct">HttpResponse</a></td><td class="docblock-short"><p>An HTTP response.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.IntrospectionRequest.html" title="oauth2::IntrospectionRequest struct">IntrospectionRequest</a></td><td class="docblock-short"><p>A request to introspect an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.IntrospectionUrl.html" title="oauth2::IntrospectionUrl struct">IntrospectionUrl</a></td><td class="docblock-short"><p>URL of the client’s <a href="https://tools.ietf.org/html/rfc7662">RFC 7662 OAuth 2.0 Token Introspection</a> endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.PasswordTokenRequest.html" title="oauth2::PasswordTokenRequest struct">PasswordTokenRequest</a></td><td class="docblock-short"><p>A request to exchange resource owner credentials for an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.PkceCodeChallenge.html" title="oauth2::PkceCodeChallenge struct">PkceCodeChallenge</a></td><td class="docblock-short"><p>Code Challenge used for <a href="(https://tools.ietf.org/html/rfc7636)">PKCE</a> protection via the
<code>code_challenge</code> parameter.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.PkceCodeChallengeMethod.html" title="oauth2::PkceCodeChallengeMethod struct">PkceCodeChallengeMethod</a></td><td class="docblock-short"><p>Code Challenge Method used for <a href="(https://tools.ietf.org/html/rfc7636)">PKCE</a> protection
via the <code>code_challenge_method</code> parameter.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.PkceCodeVerifier.html" title="oauth2::PkceCodeVerifier struct">PkceCodeVerifier</a></td><td class="docblock-short"><p>Code Verifier used for <a href="(https://tools.ietf.org/html/rfc7636)">PKCE</a> protection via the
<code>code_verifier</code> parameter. The value must have a minimum length of 43 characters and a
maximum length of 128 characters.  Each character must be ASCII alphanumeric or one of
the characters “-” / “.” / “_” / “~”.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RedirectUrl.html" title="oauth2::RedirectUrl struct">RedirectUrl</a></td><td class="docblock-short"><p>URL of the client’s redirection endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RefreshToken.html" title="oauth2::RefreshToken struct">RefreshToken</a></td><td class="docblock-short"><p>Refresh token used to obtain a new access token (if supported by the authorization server).</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RefreshTokenRequest.html" title="oauth2::RefreshTokenRequest struct">RefreshTokenRequest</a></td><td class="docblock-short"><p>A request to exchange a refresh token for an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ResourceOwnerPassword.html" title="oauth2::ResourceOwnerPassword struct">ResourceOwnerPassword</a></td><td class="docblock-short"><p>Resource owner’s password used directly as an authorization grant to obtain an access
token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ResourceOwnerUsername.html" title="oauth2::ResourceOwnerUsername struct">ResourceOwnerUsername</a></td><td class="docblock-short"><p>Resource owner’s username used directly as an authorization grant to obtain an access
token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ResponseType.html" title="oauth2::ResponseType struct">ResponseType</a></td><td class="docblock-short"><p>Authorization endpoint response (grant) type defined in
<a href="https://tools.ietf.org/html/rfc6749#section-3.1.1">Section 3.1.1</a>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RevocationRequest.html" title="oauth2::RevocationRequest struct">RevocationRequest</a></td><td class="docblock-short"><p>A request to revoke a token via an <a href="https://tools.ietf.org/html/rfc7009#section-2.1"><code>RFC 7009</code></a> compatible
endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RevocationUrl.html" title="oauth2::RevocationUrl struct">RevocationUrl</a></td><td class="docblock-short"><p>URL of the authorization server’s RFC 7009 token revocation endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Scope.html" title="oauth2::Scope struct">Scope</a></td><td class="docblock-short"><p>Access token scope, as defined by the authorization server.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StandardErrorResponse.html" title="oauth2::StandardErrorResponse struct">StandardErrorResponse</a></td><td class="docblock-short"><p>Error response returned by server after requesting an access token.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StandardTokenIntrospectionResponse.html" title="oauth2::StandardTokenIntrospectionResponse struct">StandardTokenIntrospectionResponse</a></td><td class="docblock-short"><p>Standard OAuth2 token introspection response.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StandardTokenResponse.html" title="oauth2::StandardTokenResponse struct">StandardTokenResponse</a></td><td class="docblock-short"><p>Standard OAuth2 token response.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.TokenUrl.html" title="oauth2::TokenUrl struct">TokenUrl</a></td><td class="docblock-short"><p>URL of the authorization server’s token endpoint.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UserCode.html" title="oauth2::UserCode struct">UserCode</a></td><td class="docblock-short"><p>User code returned by the device authorization endpoint and used by the user to authorize at
the verification URI.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.AuthType.html" title="oauth2::AuthType enum">AuthType</a></td><td class="docblock-short"><p>Indicates whether requests to the authorization server should use basic authentication or
include the parameters in the request body for requests in which either is valid.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ConfigurationError.html" title="oauth2::ConfigurationError enum">ConfigurationError</a></td><td class="docblock-short"><p>There was a problem configuring the request.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.RequestTokenError.html" title="oauth2::RequestTokenError enum">RequestTokenError</a></td><td class="docblock-short"><p>Error encountered while requesting access token.</p>
</td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.ErrorResponse.html" title="oauth2::ErrorResponse trait">ErrorResponse</a></td><td class="docblock-short"><p>Server Error Response</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.ErrorResponseType.html" title="oauth2::ErrorResponseType trait">ErrorResponseType</a></td><td class="docblock-short"><p>Error types enum.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.ExtraTokenFields.html" title="oauth2::ExtraTokenFields trait">ExtraTokenFields</a></td><td class="docblock-short"><p>Trait for adding extra fields to the <code>TokenResponse</code>.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.TokenIntrospectionResponse.html" title="oauth2::TokenIntrospectionResponse trait">TokenIntrospectionResponse</a></td><td class="docblock-short"><p>Common methods shared by all OAuth2 token introspection implementations.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.TokenResponse.html" title="oauth2::TokenResponse trait">TokenResponse</a></td><td class="docblock-short"><p>Common methods shared by all OAuth2 token implementations.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.TokenType.html" title="oauth2::TokenType trait">TokenType</a></td><td class="docblock-short"><p>Trait for OAuth2 access tokens.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="oauth2" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script></body></html>