#!/bin/bash
set -euo pipefail

COMMAND="cargo"
ARGUMENTS=(sqlx prepare "$@")

echo "> $COMMAND" "$(printf "%q " "${ARGUMENTS[@]}")"
eval "$COMMAND" "${ARGUMENTS[@]}"

# Formatting the result file so that diffs are pretty
COMMAND2="npx"
ARGUMENTS2=(prettier --write sqlx-data.json)

echo "> $COMMAND2" "$(printf "%q " "${ARGUMENTS2[@]}")"
eval "$COMMAND2" "${ARGUMENTS2[@]}"
