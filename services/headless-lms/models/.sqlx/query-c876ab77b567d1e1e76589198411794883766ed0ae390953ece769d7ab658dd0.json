{
  "db_name": "PostgreSQL",
  "query": "\n    SELECT\n        umc.id,\n        umc.course_id,\n        umc.course_language_group_id,\n        umc.user_id,\n        umc.user_mailchimp_id,\n        umc.consent,\n        umc.email_subscription_in_mailchimp,\n        umc.created_at,\n        umc.updated_at,\n        umc.deleted_at,\n        umc.synced_to_mailchimp_at,\n        u.first_name AS first_name,\n        u.last_name AS last_name,\n        u.email AS email,\n        c.name AS course_name,\n        c.language_code AS locale,\n        CASE WHEN cmc.passed IS NOT NULL THEN cmc.passed ELSE NULL END AS completed_course\n    FROM user_marketing_consents AS umc\n    JOIN user_details AS u ON u.user_id = umc.user_id\n    JOIN courses AS c ON c.id = umc.course_id\n    LEFT JOIN course_module_completions AS cmc\n        ON cmc.user_id = umc.user_id AND cmc.course_id = umc.course_id\n    WHERE umc.course_language_group_id = $1\n    AND (umc.synced_to_mailchimp_at IS NULL OR umc.synced_to_mailchimp_at < u.updated_at)\n    ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "course_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 2,
        "name": "course_language_group_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 3,
        "name": "user_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 4,
        "name": "user_mailchimp_id",
        "type_info": "Varchar"
      },
      {
        "ordinal": 5,
        "name": "consent",
        "type_info": "Bool"
      },
      {
        "ordinal": 6,
        "name": "email_subscription_in_mailchimp",
        "type_info": "Varchar"
      },
      {
        "ordinal": 7,
        "name": "created_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 8,
        "name": "updated_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 9,
        "name": "deleted_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 10,
        "name": "synced_to_mailchimp_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 11,
        "name": "first_name",
        "type_info": "Varchar"
      },
      {
        "ordinal": 12,
        "name": "last_name",
        "type_info": "Varchar"
      },
      {
        "ordinal": 13,
        "name": "email",
        "type_info": "Varchar"
      },
      {
        "ordinal": 14,
        "name": "course_name",
        "type_info": "Varchar"
      },
      {
        "ordinal": 15,
        "name": "locale",
        "type_info": "Varchar"
      },
      {
        "ordinal": 16,
        "name": "completed_course",
        "type_info": "Bool"
      }
    ],
    "parameters": {
      "Left": ["Uuid"]
    },
    "nullable": [
      false,
      false,
      false,
      false,
      true,
      false,
      true,
      false,
      false,
      true,
      true,
      true,
      true,
      false,
      false,
      false,
      null
    ]
  },
  "hash": "c876ab77b567d1e1e76589198411794883766ed0ae390953ece769d7ab658dd0"
}
